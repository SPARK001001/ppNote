**线程基础：**

### 什么是线程，线程与进程的区别。

- 线程（Thread）是程序执行的最小单位，是进程内的一个独立执行路径。一个进程可以包含多个线程，这些线程共享进程的资源，如内存空间、文件句柄等。线程可以看作是进程内部的分支，每个线程执行自己的指令序列。

  以下是线程与进程的主要区别：

  1. **定义：**
     - 进程：进程是一个独立的执行单元，拥有独立的地址空间和系统资源。它可以包含一个或多个线程。
     - 线程：线程是进程内的执行单元，共享进程的资源。多个线程可以同时运行于同一个进程内。

  2. **资源共享：**
     - 进程：不同进程之间的资源不共享，每个进程有自己独立的内存空间。
     - 线程：同一进程内的线程共享进程的资源，如内存、文件句柄等。

  3. **通信成本：**
     - 进程：由于不同进程间资源不共享，需要使用 IPC（Inter-Process Communication）机制进行通信，成本较高。
     - 线程：线程间通信更加直接，可以使用共享内存等低成本的方式。

  4. **创建与销毁：**
     - 进程：创建和销毁进程的代价较高，因为需要分配和回收独立的资源。
     - 线程：创建和销毁线程的代价较低，因为它们共享进程的资源。

  5. **切换开销：**
     - 进程：由于进程间切换需要切换内存空间，切换开销相对较大。
     - 线程：线程切换的开销较小，因为它们共享进程的内存空间。

  6. **独立性：**
     - 进程：进程之间相对独立，一个进程的崩溃通常不会影响其他进程。
     - 线程：线程之间共享相同的地址空间，一个线程的错误可能影响整个进程。

  7. **并发性：**
     - 进程：不同进程之间的并发性较高，可以在不同的 CPU 上并发执行。
     - 线程：线程共享进程的资源，可以在同一 CPU 上并发执行，但并发控制需要考虑线程同步。

  总之，线程是进程内的执行单元，多线程编程可以更有效地利用计算机资源，但也需要注意线程间的同步和互斥，以避免并发问题。

### 线程的生命周期：新建、就绪、运行、阻塞、死亡。

- 线程的生命周期描述了线程从创建到终止的不同阶段和状态。以下是线程的生命周期各个阶段：

  1. **新建（New）：**
     在这个阶段，线程被创建，但还没有开始执行。此时线程对象已经被创建，但线程并没有开始运行。

  2. **就绪（Runnable）：**
     在新建后，线程进入就绪状态。这表示线程已经准备好运行，但可能还没有被调度到 CPU 上执行。线程在就绪状态下等待操作系统的调度，以便进入运行状态。

  3. **运行（Running）：**
     一旦线程被操作系统调度，它会进入运行状态。此时线程的指令在 CPU 上执行，实际进行任务。

  4. **阻塞（Blocked）：**
     在运行状态下，线程可能因为某些原因被阻塞。阻塞可能是因为等待输入、等待资源、等待其他线程释放锁等情况。在线程被阻塞时，它将暂时停止执行，直到解除阻塞并重新进入就绪状态。

  5. **死亡（Terminated）：**
     有几种情况会导致线程进入死亡状态：
     - 线程的 `run()` 方法执行完毕。
     - `stop()` 方法被调用，但不推荐使用 `stop()`，因为它可能导致线程不安全的状态。
     - 线程抛出未捕获的异常而终止。
     
     一旦线程进入死亡状态，它就不能再回到其他状态。

  需要注意的是，线程在不同状态之间切换是由操作系统的线程调度器负责的。线程的状态转换通常是由操作系统根据特定的调度策略进行管理的，因此程序员无法精确控制线程的状态转换。

### 主线程和用户线程的区别。

- 主线程（Main Thread）和用户线程（User Thread）是多线程编程中两种不同类型的线程，它们有一些重要的区别。

  **主线程：**

  1. **主线程是程序的入口：** 主线程是程序启动时第一个被创建和执行的线程，它是整个程序的入口点。
     
  2. **系统级线程：** 主线程通常由操作系统创建和管理，它负责执行 `main()` 方法中的代码，初始化程序的各个部分，以及创建其他用户线程。

  3. **生命周期受程序控制：** 主线程的生命周期受整个程序的控制，它在程序启动时被创建，一直运行到程序结束。

  4. **通常是非守护线程：** 主线程通常是非守护线程，即使其他用户线程都执行完毕，主线程仍然会等待自己的任务完成。

  5. **有特殊作用：** 主线程通常用于执行一些初始化任务，创建其他线程，以及监控和协调其他线程的运行。

  **用户线程：**

  1. **由程序员创建和管理：** 用户线程是由程序员在程序中显式地创建和管理的线程。

  2. **生命周期独立：** 用户线程的生命周期与主线程独立，它可以在程序运行过程中被创建、运行、阻塞和销毁。

  3. **通常是守护线程：** 用户线程可以是守护线程或非守护线程。当程序中所有非守护线程都执行完毕时，守护线程会被强制终止。

  4. **用于并发任务：** 用户线程用于执行实际的并发任务，它们可以执行各种业务逻辑，处理数据等。

  总之，主线程是程序的入口，负责整个程序的初始化和管理，而用户线程是程序员用来执行实际任务的线程，它们有不同的创建方式、生命周期和作用。