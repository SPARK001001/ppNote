TCP（传输控制协议）是一种在计算机网络中常用的协议，用于可靠地传输数据。以下是一些常见的 TCP 考点：

1. **连接建立和终止：**
   - TCP 使用三次握手来建立连接，确保通信双方都准备好进行数据传输。
   - 连接终止时，TCP 使用四次挥手来关闭连接，确保双方都完成了数据传输并愿意终止连接。
	- TCP连接的建立和终止是通过三次握手和四次挥手来完成的。

		连接建立的**三次握手**过程如下：
		1. 第一次握手（SYN）：客户端发送一个带有SYN（同步）标志的TCP报文段，指定客户端的初始序列号（ISN）。
		2. 第二次握手（SYN+ACK）：服务器收到客户端的SYN后，发送一个带有SYN和ACK（确认）标志的TCP报文段作为应答，确认客户端的SYN请求，并指定服务器的初始序列号（ISN）。
		3. 第三次握手（ACK）：客户端收到服务器的SYN+ACK后，发送一个带有ACK标志的TCP报文段给服务器，确认收到服务器的应答。此时连接建立成功，可以开始传输数据。
		
		连接终止的**四次挥手**过程如下：
		1. 第一次挥手（FIN）：当客户端想要关闭连接时，发送一个带有FIN（结束）标志的TCP报文段给服务器，表示客户端不再发送数据。
		2. 第二次挥手（ACK）：服务器收到客户端的FIN后，发送一个带有ACK标志的TCP报文段作为确认，表示服务器收到了客户端的关闭请求。
		3. 第三次挥手（FIN）：服务器在关闭之前可能还有数据需要发送，当数据发送完毕后，服务器发送一个带有FIN标志的TCP报文段给客户端，表示服务器也准备关闭连接。
		4. 第四次挥手（ACK）：客户端收到服务器的FIN后，发送一个带有ACK标志的TCP报文段作为确认，表示客户端接受到了服务器的关闭请求。等待time_wait后此时连接终止，连接双方都进入CLOSED状态。
		
		通过三次握手和四次挥手过程，TCP连接可以可靠地建立和终止，确保数据的可靠传输和双方的协调关闭。
		- **Time_wait状态：**
			- Time-Wait 状态是在 TCP 连接关闭过程中的一个状态，它是为了确保可靠的连接终止而引入的一种延迟状态。当 TCP 连接关闭时，**主动关闭连接**的一方会进入 Time-Wait 状态。

			Time-Wait 状态的作用和原因包括：
			
			1. 确保完整的数据传输：在关闭连接之前，主动关闭连接的一方会等待一段时间（通常是两倍的最大报文段生存时间，即 2MSL）以确保所有可能的延迟报文段都被接收。这样可以防止在关闭连接后，可能有残留的报文段被后续的连接误认为是当前连接的报文段。
			
			2. 防止旧连接的报文干扰：在 Time-Wait 状态期间，主动关闭连接的一方会保留连接的终止信息。这样可以防止其他连接使用相同的源 IP 地址和端口号来与服务器通信，避免旧连接的报文干扰到新的连接。
			
			3. 处理可能的重复报文：如果最后一个 ACK 报文段在传输过程中丢失，被动关闭连接的一方会重新发送最后一个 FIN。而主动关闭连接的一方在 Time-Wait 状态中会重新接收到这个重复的 Fin 报文段，通过丢弃重复的报文段来保证报文的有序处理。
			4.  **为什么是维持2MSL**
				- 一个`MSL`是确保主动关闭方最后的`ACK`能够到达对端。
				- 一个`MSL`是确保被动关闭方重发的`FIN`能够被主动关闭方收到。
			
			Time-Wait 状态的持续时间通常是几分钟，具体取决于操作系统的实现。这段时间可以确保连接的可靠关闭，并防止旧连接的干扰。在高负载的服务器上，Time-Wait 状态可能会导致端口资源的耗尽，因此在某些情况下，可以通过调整操作系统的参数来缩短 Time-Wait 状态的持续时间。
			
			总结起来，Time-Wait 状态是为了保证连接的可靠关闭而引入的一种延迟状态，它在连接关闭后一段时间内保留连接信息，防止数据的混淆和重复，并确保新连接不受旧连接的干扰。
			
			**time_wait的危害**
			一个web服务器最大的端口数量是65535个，如果这个服务器作为客户端不停的和服务端不停的创建短连接，就会导致有大量的TCP进入`TIME_WAIT`状态。
			
			当服务端是主动关闭方，因为有`TIME_WAIT`状态的存在，在重启程序的时候可能会出现`java.net.BindException: Address already in use`的错误，这是因为这个端口`TIME_WAIT`状态需要等待`2MSL`

2. **可靠性和流量控制：**
   - TCP 提供可靠的数据传输，通过序号和确认机制来确保数据的有序和完整到达目的地。
   - TCP 使用滑动窗口机制进行流量控制，确保发送方不会淹没接收方，以适应接收方的处理能力。

3. **拥塞控制：**
   - TCP 使用拥塞控制算法来避免网络拥塞，并保持网络的稳定性和公平性。
   - 拥塞控制算法包括慢启动、拥塞避免和拥塞检测等，通过动态调整发送速率来适应网络状况。

4. **数据分段和重组：**
   - TCP 将应用层的数据分割成适当大小的报文段进行传输，以适应网络的最大传输单元（MTU）大小。
   - 在接收端，TCP 会将接收到的报文段进行重组，以恢复原始的应用层数据。

5. **端口和套接字：**
   - TCP 使用端口号来标识不同的应用程序或服务，使得数据可以正确地传输到目标进程。
   - 一个 TCP 连接由源 IP 地址、源端口号、目标 IP 地址和目标端口号唯一标识，称为套接字。

6. **TCP/IP 协议栈：**
   - TCP 是在传输层上工作的协议，与网络层（如 IP）和应用层（如 HTTP）协议配合使用，构成了 TCP/IP 协议栈。

了解这些 TCP 的基本概念和工作原理对于理解计算机网络中的数据传输和通信非常重要。在学习和应用网络编程、网络安全和网络性能优化等领域时，这些考点都是需要重点关注的内容。