# 重要概念

## 虚拟内存

- 概念： 是一种操作系统的内存管理技术，为每个进程提供一个似乎连续、非常大的地址空间，远超实际物理地址大小                                                       
- 作用：给每个进程提供独立的连续地址空间，称为虚拟地址哦空间。从而允许每个进程独立进行，互不干扰，简化程序编写和运行
- 工作原理：通过将虚拟地址空间映射到物理内存ram上的真实地址空间来实现。进程访问虚拟地址时，操作系统通过**分页或分段**技术将虚拟地址映射到物理地址。如果所需指令或数据**不在物理内存**，操作系统通过**页面置换算法**将不需要的页面从内存中换出，再将所需的页面从磁盘加载到内存中
- 好处：
  - 运行进程有大量地址空间，提高进程运行能力
  - 每个进程独立进行，防止了相互干扰
  - 进程之间可以共享数据和代码，节省内存使用
- 不足：页面置换的开销和虚拟地址到物理地址的映射开销。

## 分页和分段：

- 是两种不同的内存管理方式，用于实现虚拟内存
- 分页：
  - 特点：将进程的虚拟地址空间划分为固定大小的页（page）,同时将物理地址也划分为与页相同大小的的物理页帧（page frame）.通过页表将进程的虚拟页映射到物理页帧上，从而实现虚拟地址到物理地址的转换。
  - 优点: 页大小固定，易于管理和分配。允许进程拥有连续虚拟地址空间。
  - 缺点：产生内部碎片，当一个页被加载到内存中时，可能存在部分未使用的空间。
  - 应用： linux, windows采用的分页方式实现
- 分段：
  - 特点： 将进程的虚拟地址空间划分为不同大小的段（segment）,每个段可以是代码段、数据段和堆栈段。不同段大小可以不同，根据进程需要进行动态分配。
  - 优点：允许不同段大小不同，适用不同类型的数据和代码。避免产生内部碎片
  - 缺点：地址转换复杂化，需要多级段表。可能产生外部碎片，不同段的大小不一定能够充分利用内存空间。
  - 应用： 实时操作系统或特定的应用程序

## 内存分配：

- 指将进程请求的内存分配给进程，并要高效的利用内存空间，尽量避免内存碎片。
- 常见内存分配算法和策略
  - 首次适应（first fit）: 内存空闲列表中找到第一个能满足的分配。简单快速，但可能导致内存碎片
  - 最佳适应（best fit）: 从空闲列表找能满足且大小最接近的进行分配。减少内存碎片但耗时长
  - 最坏适应（worst fit）: 找能满足且大小最大的进行分配。产生较大内存碎片但某些情况可以更好利用内存空间。
  - 临近合并（buddy system）: 解决内存碎片问题的一种方法。一块内存空间被释放时，尝试将其相邻的空闲区域合并。
  - 空间分配表（free list): 维护空闲区域的链表会数组，将内存划分为不同大小的块，当进程请求内存时，从合适的块中选择一个分配。
  - 内存压缩（memory compaction）: 出现大量内存碎片时，进行内存压缩操作，将分配的内存区域向一端移动，使所有空闲区域连续排列，形成更大的连续空闲区域

## 内存保护：

- 目的是防止进程之间相互干扰和防止进程访问非法内存区域。
- 常见内存保护机制
  - 虚拟内存
  - 权限位
  - 内存隔离
  - 堆栈保护
  - 内存交换
  - 内存检测和保护机制

内存映射：

虚拟地址空间

分页表和页表项：

页面置换算法：

内存管理单元（MMU）:

内存管理中的并发控制：

内存优化：